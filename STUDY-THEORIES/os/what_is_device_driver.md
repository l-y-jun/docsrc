---
title: "What_is_device_driver"
date: 2022-02-07T11:44:02+09:00
categories:
- STUDY
- OS
- DEVICE DRIVER
tags:
- device driver
---

Device driver과 CPU
-------------------

운영체제가 없는 상태에서, 디바이스를 조작하기 위해서 디바이스 제작자는 디바이스의 사용에 맞는 인터페이스를 구현해 놓았을 것이다.
  초기 컴퓨터를 예로 들면 코어메모리를 직접 구성해서 컴퓨터 제작사(DEC, IBM)의 요구에 맞게 입력하여 프로그램을 동작시켜야 할 것이다.
  동작중인 프로그램이 있다면 동시에 동작할 수 없고, 입력-처리를 위한 방식의 특수성 또한 난이도가 높다.
  이를 보완하기 위하여 OS가 등장하면서 아마 동시다발적으로 등장한 개념이 디바이스 드라이버이다.

버그나 해킹을 목적으로 디바이스 드라이버를 통해 디바이스에 접근함이라는 룰을 깨고 동시에 다양한 프로세스가 디바이스를 조작하려고 시도하는 경우,
  리눅스는 이러한 문제를 피하고자 CPU에 있는 기능을 이용, 프로세스가 직접 하드웨어에 접근하는 것을 차단한다.
  디바이스 드라이버는 2가지의 모드로 분류된다.

  - 커널모드-디바이스 드라이버: core system의 디바이스에 접근하여 조작하는 모드(1번 메모리를 조작하거나, CPU레지스터의 저장 중인 값을 변경하거나)의 드라이버
  - 사용자모드-디바이스 드라이버: 컴퓨터 시스템에 필수적이지는 않지만, OS가 인식가능하며 기능을 수행할 수 있는 디바이스의 드라이버

쉽게말하면, 운영체제는 컴퓨터 시스템의 여러 부품들의 존재를 알고 일부는 컴퓨터의 구성요소에 해당하는 필수적인 장치들인데,
  그들을 개별적인 장치로서 사용한다고 했을 때, 이는 컴퓨팅 시스템의 것이기 때문에 커널이 허락하는 방식으로만 가능하다.
  사용자는 어떤 방식으로건 그 디바이스들을 사용하고자 하는 경우에 CPU에게 그 약속을 위임한다. CPU는 디바이스에 따라 커널모드, 사용자 모드의 소프트웨어로 처리를 대신한다.
  이때에, CPU는 커널모드-디바이스 드라이버에 접근할 수 있는, 커널모드의 동작상태를 가진다.
  사용자의 프로세스는 사용자 모드의 상태에서 동작한다.

메모리는 CPU와 함께 동작하는 기능에 필수적이라 할 수 있는데,
  메모리 또한 OS는 커널 영역, 사용자 영역으로 분류한다.
  예상하다시피, CPU가 커널모드로 동작중일 때는 커널모드 메모리를 사용하고, 사용자의 실행 상태들은 사용자 영역에 저장된다.

Device driver란 무엇인가?
-------------------------

*Device Driver*
> 컴퓨팅에서 이는 특별한 종류의 소프트웨어 프로그램 혹은, 특별한 타입의 소프트웨어 어플리케이션이다.  
> 이 소프트웨어는 다른 하드웨어 디바이스를 컴퓨터OS와 데이터를 송수신 할 수 있도록 하는 특정한 하드웨어 디바이스를 조작하는 소프트웨어이다.  
> 디바이스 드라이버는 하드웨어와 직접 연결된 컴퓨터 버스 혹은 컴퓨터의 서브시스템을 통해서 컴퓨터와 데이터를 교환한다.  
> 디바이스 드라이버가 없다면, 하드웨어의 동작 실패는 그대로 해당 기능의 실패를 의미하기 때문에 컴퓨터시스템이 적합하게 동작하기 위해서는 반드시 필요하다.

일반적으로 driver, hardware driver라고 말하는 것은 이 *device driver*를 의미한다.

Working of device driver
------------------------

디바이스 드라이버는 OS의 인스럭션에 의존하여 디바이스에 접근하거나, 특정 동작을 수행할 수 있다.
  해당 동작 이후에 출력, 상태/메세지를 하드웨어 디바이스에서부터, OS로 전달하는 것으로 그들은 리액션한다.

예로는,
- 프린터 드라이버가 OS에서 명령을 얻고난 후 프린터에게 어떤 포멧을 출력할지 전달한다.
- 사운드카드 드라이버는 디지털 mp3입력파일을 입력받아, 아날로그(audio signal)로 전환하여 우리는 음악을 들을 수 있다.
- 카드리더, 모뎀, 네트워크카드, 사운드카드, 프린터, 비디오카드, USB디바이스, RAM, 스피커 등은 모두 디바이스 드라이버가 있어야 적절히으로 동작할 수 있다.

Type of Device Driver
---------------------

컴퓨터 시스템과 연결된 대부분의 하드웨어 디바이스는 그들을 위한 디바이스 드라이버가 존재한다.
하지만, 크게 2가지 타입으로 분류될 수 있다.

1. Kernel-mode Device Driver
  - 이 커널모드 디바이스 드라이버는 OS와 함께 읽어지는 BIOS, motherboard, processor 등의 일반형 하드웨어를 포함한다.  
이들은 각 OS에 대한 최소한의 시스템 요구사항의 디바이스 드라이버들을 포함한다.
2. User-mode Device Driver
  - 시스템의 동작을 위해 커널에 의해 호출되는 디바이스 이외에, 사용자 또한 시스템의 사용 중에 사용할 디바이스들을 가져온다.  
그 디바이스들은 기능하기 위해서 드라이버들을 필요로 하는데, 유저모드 디바이스 드라이버 아래로 떨어진다.  
예로는, plug and play에 속하는 것이 이에 해당한다.

Virtural Device Driver
  - 가상-디바이스를 조작하는 드라이버이다.
     때로 우리는 같은 하드웨어를 가상으로 사용하며, 그때 가상 드라이버는 같은 디바이스가 다른 유저들에 의해 다른 어플리케이션으로부터 사용되는 데이터의 흐름을 조작한다.

컴퓨터의 각 부분에 맞는 디바이스 드라이버는 시스템이 효율적으로 동작하도록 유지하기 위해서 필수적이다.
많은 디바이스 드라이버들이 생산자로부터 공급되고, 우리는 또한 이후에 우리의 시스템에 필요한 어떤 디바이스라도 추가할 수 있다.

